from pyspark.sql import SparkSessionfrom pyspark.sql.functions import *from pyspark.sql.types import IntegerType, DoubleTypespark = SparkSession.builder\    .config("spark.sql.shuffle.partitions", "2")\    .appName("demo01")\    .master("local[2]")\    .getOrCreate()startups = spark.read\    .option("header", "true")\    .option("delimiter", ",")\    .option("inferSchema", "true")\    .csv("/home/sunbeam/startup.csv")# newDf = startups.withColumn('Amount_in_USD', regexp_replace('Amount_in_USD', '^A-z+$','0'))# newDf.show()newDf = startups.withColumn('Amount_in_USD', regexp_replace('Amount_in_USD', ',',''))newDf.createOrReplaceTempView("stup_view")sql = "SELECT City, SUM(CAST(Amount_in_USD AS INT)) FROM stup_view GROUP BY City limit 5"result = spark.sql(sql)result.printSchema()result.show()spark.stop()